{"version":3,"sources":["reducers/lines.js","reducers/cursor.js","reducers/index.js","actions/index.js","components/Line.js","utils/render.js","render/mermaid.js","render/hljs.js","components/Lines.js","components/App.js","index.js","../node_modules/moment-mini/locale sync /^/.*$"],"names":["lines","newState","state","arguments","length","undefined","text","action","type","console","log","no","preview","map","item","index","slice","splice","cursor","col","row","dirty","combineReducers","changeLine","insertLine","setCursor","Line","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","send","bind","assertThisInitialized","keyHandler","clickHandler","e","onChange","target","value","keyCode","onTab","shiftKey","preventDefault","onUp","selectionStart","onDown","selectionEnd","onLeftUp","onEnter","onBS","onClick","isBlock","react_default","a","createElement","className","style","display","isFocus","ref","height","onKeyDown","dangerouslySetInnerHTML","__html","refs","rawInput","focus","that","setTimeout","setSelectionRange","column","onRefreshed","updateFocus","React","Component","Render","getLines","firstLine","lastPart","parts","split","ret","join","render","elementId","preRenderedElement","document","getElementById","innerHTML","parentNode","removeChild","mermaidAPI","parse","svgCode","str","mermaidRender","hljs","highlightAuto","hljsRender","indexOf","getCursorPos","i","list","pos","numLines","s","Lines","line","components_Line","assign","key","onBSfunc","addFocus","addClassName","calcClassName","addHeight","addIsBlock","LinesContainer","connect","ownProps","dispatch","upText","pop","firstPart","downText","num","Math","min","shift","t1","t2","search","pretext","t","deleteLine","App","components_Lines","store","createStore","rootReducer","loadLine","initialize","startOnLoad","theme","ReactDOM","es","components_App","./locale","./locale.js","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","Error","code","keys","resolve","module","exports"],"mappings":"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","file":"static/js/main.a1755a29.chunk.js","sourcesContent":["function lines(state = [{text:\"\"}], action){\r\n  let newState;\r\n  switch(action.type){\r\n    case 'PREVIEW_LINE':\r\n      console.log(\"PREVIEW_LINE\", action.no, action.preview)\r\n      return state.map((item, index) => {\r\n        if(index !== action.no){\r\n          return item\r\n        }\r\n        return {\r\n          text: item.text,\r\n          preview: action.preview\r\n        }\r\n      })\r\n    case 'CHANGE_LINE':\r\n      console.log(\"CHANGE_LINE\", action.no, action.text)\r\n      return state.map((item, index) => {\r\n        if(index !== action.no){\r\n          return item\r\n        }\r\n        return {\r\n          text: action.text,\r\n          preview: action.preview\r\n        }\r\n      })\r\n    case 'INSERT_LINE':\r\n      console.log(\"INSERT_LINE\", action.no, action.text)\r\n      newState = state.slice()\r\n      newState.splice(action.no, 0, {\r\n        text: action.text,\r\n        preview: action.preview\r\n      })\r\n      return newState\r\n    case 'DELETE_LINE':\r\n      console.log(\"DELETE_LINE\", action.no)\r\n      newState = state.slice()\r\n      newState.splice(action.no, 1)\r\n      return newState\r\n    default:\r\n      // pass\r\n  }\r\n  return state\r\n}\r\n\r\nexport default lines\r\n","function cursor(state = {col: 0, row: 0, dirty: false}, action){\r\n  switch(action.type){\r\n    case 'SET_CURSOR':\r\n      return {\r\n        row: action.row,\r\n        col: action.col,\r\n        dirty: action.dirty,\r\n      }\r\n    default:\r\n      // pass\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default cursor\r\n","import { combineReducers } from 'redux'\r\nimport lines from './lines'\r\nimport cursor from './cursor'\r\n\r\nexport default combineReducers({\r\n  lines,\r\n  cursor,\r\n})\r\n\r\n\r\n","\r\nexport const previewLine = (no, html) => ({\r\n  type: 'PREVIEW_LINE',\r\n  html,\r\n  no,\r\n})\r\n\r\nexport const changeLine = (no, text, preview) => ({\r\n  type: 'CHANGE_LINE',\r\n  text,\r\n  preview,\r\n  no,\r\n})\r\n\r\nexport const deleteLine = (no, text) => ({\r\n  type: 'DELETE_LINE',\r\n  text,\r\n  no,\r\n})\r\n\r\nexport const insertLine = (no, text, preview) => ({\r\n  type: 'INSERT_LINE',\r\n  text,\r\n  preview,\r\n  no,\r\n})\r\n\r\nexport const setCursor = (row, col, dirty) => ({\r\n  type: 'SET_CURSOR',\r\n  row,\r\n  col,\r\n  dirty,\r\n})\r\n\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types'\r\n\r\nclass Line extends React.Component{\r\n  constructor(props) {\r\n    super(props)\r\n    this.send = this.send.bind(this);\r\n    this.keyHandler = this.keyHandler.bind(this);\r\n    this.clickHandler = this.clickHandler.bind(this);\r\n  }\r\n  send(e){\r\n    this.props.onChange(this.props.no, e.target.value)\r\n    return;\r\n  }\r\n  keyHandler(e){\r\n    switch(e.keyCode){\r\n      case 9: // tab\r\n      this.props.onTab(this.props.no, this.props.text, e.shiftKey);\r\n      e.preventDefault()\r\n      break\r\n      case 38: //up\r\n      this.props.onUp(this.props.no, e.target.selectionStart, this.props.text)\r\n      break;\r\n      case 40: //down\r\n      this.props.onDown(this.props.no, e.target.selectionStart, this.props.text)\r\n      break;\r\n      case 37: //left\r\n      // when cursor is head\r\n      if(e.target.selectionStart === 0 && e.target.selectionEnd === 0){\r\n        this.props.onLeftUp(this.props.no)\r\n      }else{\r\n      }\r\n      break;\r\n      case 39: //right\r\n      // when cursor is end\r\n      if(e.target.selectionStart === this.props.text.length){\r\n        this.props.onDown(this.props.no, 0, this.props.text)\r\n      }else{\r\n      }\r\n      break;\r\n      case 13: //enter\r\n      if(!this.props.onEnter(this.props.no, this.props.text, e.target.selectionStart, e.shiftKey)){\r\n        e.preventDefault()\r\n      }\r\n      break;\r\n      case 8: //BS\r\n      // when cursor is head\r\n      if(e.target.selectionStart === 0 && e.target.selectionEnd === 0){\r\n        this.props.onBS(this.props.no, this.props.text)\r\n        e.preventDefault()\r\n      }\r\n      break;\r\n      default:\r\n        // pass\r\n    }\r\n  }\r\n  clickHandler(e){\r\n    this.props.onClick(this.props.no);\r\n  }\r\n  render() {\r\n    if(this.props.isBlock){\r\n      return (\r\n        <div className={'line ' + this.props.className} onClick={this.clickHandler}>\r\n          <div style={{display: this.props.isFocus?\"block\":\"none\"}}>\r\n            <textarea ref=\"rawInput\" style={{height: this.props.height}} onChange={this.send} onKeyDown={this.keyHandler} value={this.props.text} />\r\n          </div>\r\n          <div>\r\n            <div dangerouslySetInnerHTML={{__html:this.props.preview}} />\r\n          </div>\r\n        </div>\r\n      )\r\n    }else{\r\n      // inline\r\n      return (\r\n        <div className={'line ' + this.props.className} onClick={this.clickHandler}>\r\n          <div style={{display: this.props.isFocus?\"block\":\"none\"}}>\r\n            <textarea ref=\"rawInput\" style={{height: this.props.height}} onChange={this.send} onKeyDown={this.keyHandler} value={this.props.text} />\r\n          </div>\r\n          <div style={{display: !this.props.isFocus?\"block\":\"none\"}}>\r\n            <div dangerouslySetInnerHTML={{__html:this.props.preview}} />\r\n          </div>\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n  updateFocus(){\r\n    if(this.props.isFocus){\r\n      this.refs.rawInput.focus();\r\n      if(this.props.dirty){\r\n        var that = this;\r\n        setTimeout(function(){\r\n          console.log(\"update cursor\");\r\n          // FIXME: remove setTimeout\r\n          that.refs.rawInput.setSelectionRange(that.props.column, that.props.column);\r\n          that.props.onRefreshed(that.props.no);\r\n        },10);\r\n      }\r\n    }\r\n  }\r\n  componentDidUpdate(){\r\n    this.updateFocus()\r\n  }\r\n  componentDidMount(){\r\n    this.updateFocus()\r\n  }\r\n\r\n}\r\nLine.propTypes = {\r\n  onChange: PropTypes.func.isRequired,\r\n  onUp: PropTypes.func.isRequired,\r\n  onDown: PropTypes.func.isRequired,\r\n  onClick: PropTypes.func.isRequired,\r\n  onLeftUp: PropTypes.func.isRequired,\r\n  onBS: PropTypes.func.isRequired,\r\n  onRefreshed: PropTypes.func.isRequired,\r\n  no: PropTypes.number.isRequired,\r\n  isBlock: PropTypes.bool.isRequired,\r\n  text: PropTypes.string.isRequired\r\n}\r\n\r\nexport default Line\r\n","import {mermaidRender} from '../render/mermaid'\r\nimport {hljsRender} from '../render/hljs'\r\n\r\nexport const Render = (no, text) => {\r\n  // TODO: sanitize!!\r\n  console.log(\"Render\", text)\r\n  if(isBlock(text)){\r\n    let lines = getLines(text);\r\n    let firstLine = lines[0];\r\n    let lastPart = lines.slice(1);\r\n    let parts = firstLine.split(/\\s+/);\r\n\r\n    let ret = \"\";\r\n    console.log(\"PARTS:\",parts)\r\n    if(parts[0] === \">>\"){\r\n      switch(parts[1]){\r\n        case \"pre\":\r\n          ret += \"<span class='mode'>&gt;&gt; pre</span>\";\r\n          ret += \"<pre>\" + lastPart.join(\"\\n\") + \"</pre>\";\r\n        break;\r\n        case \"mermaid\":\r\n          ret += \"<span class='mode'>&gt;&gt; mermaid</span>\";\r\n          ret += mermaidRender(no, lastPart);\r\n        break;\r\n        case \"code\":\r\n          ret += \"<span class='mode'>&gt;&gt; code</span>\";\r\n          console.log(\"CODE PART\",lastPart);\r\n          ret += hljsRender(no, lastPart);\r\n        break;\r\n        default:\r\n          ret += \"<pre>\" + text + \"</pre>\";\r\n      }\r\n    }else{\r\n      ret += \"<pre>\" + text + \"</pre>\";\r\n    }\r\n    return ret;\r\n  }else{\r\n    if(text.indexOf(\"###\") === 0){\r\n      return \"<div>\" + text + \"<div>\"\r\n    }else if(text.indexOf(\"##\") === 0){\r\n      return \"<div>\" + text + \"<div>\"\r\n    }else if(text.indexOf(\"#\") === 0){\r\n      return \"<div>\" + text + \"<div>\"\r\n    }\r\n    return \"<div>\"+text+\"</div>\"\r\n  }\r\n}\r\n\r\nexport const isBlock = (text) => {\r\n  return text.indexOf(\">>\") === 0\r\n}\r\n\r\n// sのindex番目がx,yで何番目か調べる\r\nexport const getCursorPos = (index, text) => {\r\n  var list = text.split(/[\\r\\n]/);\r\n  var pos = 0;\r\n  var i;\r\n  for(i = 0; i < list.length; i ++){\r\n    pos += list[i].length + 1;\r\n    if(pos > index){\r\n      // X, Y\r\n      return [index - (pos - list[i].length - 1), i]\r\n    }\r\n  }\r\n  console.log(\"error getPos\")\r\n}\r\nexport const getLines = (text) => {\r\n  var list = text.split(/[\\r\\n]/);\r\n  return list;\r\n}\r\n\r\nexport const numLines = (s) => {\r\n  return s.split(/[\\r\\n]/).length\r\n}\r\n\r\n","import {mermaidAPI} from 'mermaid'\r\n\r\nexport const mermaidRender = (no, text) => {\r\n  let render = \"\";\r\n  try{\r\n    let elementId = 'mermaid' + no;\r\n    let preRenderedElement = document.getElementById(elementId);\r\n    if(preRenderedElement){\r\n      preRenderedElement.innerHTML = \"\";\r\n      preRenderedElement.parentNode.removeChild(preRenderedElement);\r\n    }\r\n    mermaidAPI.parse(text.join(\"\\n\"));\r\n    mermaidAPI.render(elementId, text.join(\"\\n\"), function(svgCode){\r\n      render = svgCode;\r\n    })\r\n  }catch(e){\r\n    console.log(e)\r\n    render = \"<pre class='error'>\"+e.str+\"</pre>\";\r\n  }\r\n  // TODO: why can I get rendered code?\r\n  return \"<div style='width:100%;'>\"+render+\"</div>\";\r\n}\r\n","import hljs from 'highlight.js'\r\n\r\nexport const hljsRender = (no, text) => {\r\n  return '<pre class=\"hljs\">'+hljs.highlightAuto(text.join(\"\\n\")).value+'</pre>'\r\n}\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport PropTypes from 'prop-types'\r\nimport {changeLine, insertLine, deleteLine, setCursor} from '../actions'\r\nimport Line from './Line'\r\nimport {isBlock, Render, getCursorPos, numLines, getLines} from '../utils/render'\r\n\r\nclass Lines extends React.Component{\r\n  //constructor(props) {\r\n  //  super(props)\r\n  //}\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.props.lines.map((line, index) => (\r\n          <Line\r\n                key={index}\r\n                {...line}\r\n                onChange={this.props.onChange}\r\n                onUp={this.props.onUp(\r\n                        index===0?\"\":this.props.lines[index - 1])}\r\n                onDown={this.props.onDown(\r\n                        index>=this.props.lines.length - 1?\"\":this.props.lines[index + 1].text)}\r\n                onEnter={this.props.onEnter}\r\n                onTab={this.props.onTab}\r\n                onClick={this.props.onClick}\r\n                onLeftUp={this.props.onLeftUp(\r\n                        index===0?\"\":this.props.lines[index - 1].text)}\r\n                onBS={this.props.onBSfunc(\r\n                        index===0?\"\":this.props.lines[index - 1].text)}\r\n                onRefreshed={this.props.onRefreshed}\r\n                />\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n}\r\nLines.propTypes = {\r\n  onChange: PropTypes.func.isRequired,\r\n  onUp: PropTypes.func.isRequired,\r\n  onDown: PropTypes.func.isRequired,\r\n  onEnter: PropTypes.func.isRequired,\r\n  onClick: PropTypes.func.isRequired,\r\n  onBSfunc: PropTypes.func.isRequired,\r\n}\r\n\r\nconst addNumber = (lines => {\r\n  return lines.map((line, index) => {\r\n    line.no = index\r\n    return line;\r\n  })\r\n})\r\nconst addFocus = ((col, row, dirty, lines) => {\r\n  return lines.map((line, index) => {\r\n    if(index === row){\r\n      line.isFocus = true;\r\n      line.column = col;\r\n      line.dirty = dirty;\r\n    }else{\r\n      line.isFocus = false;\r\n    }\r\n    return line;\r\n  });\r\n})\r\nconst calcClassName = (text) => {\r\n  let className = \"normal\"\r\n  if(isBlock(text)){\r\n    className = \"block\"\r\n  }else{\r\n    if(text.indexOf(\"###\") === 0){\r\n      className = \"h3\"\r\n    }else if(text.indexOf(\"##\") === 0){\r\n      className = \"h2\"\r\n    }else if(text.indexOf(\"#\") === 0){\r\n      className = \"h1\"\r\n    }\r\n  }\r\n  return className;\r\n}\r\nconst addClassName = (lines => {\r\n  return lines.map(line => {\r\n    line.className = calcClassName(line.text);\r\n    if(line.isFocus){\r\n      line.className += \" focus\"\r\n    }\r\n    return line;\r\n  })\r\n})\r\nconst addHeight = (lines => {\r\n  return lines.map(line => {\r\n    line.height = numLines(line.text)*16 + \"px\"\r\n    return line;\r\n  })\r\n})\r\n\r\nconst addIsBlock = (lines => {\r\n  return lines.map(line => {\r\n    line.isBlock = isBlock(line.text)\r\n    return line;\r\n  })\r\n})\r\n\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  return {\r\n    lines: addClassName(addIsBlock(addHeight(addFocus(state.cursor.col, state.cursor.row, state.cursor.dirty, addNumber(state.lines))))),\r\n    cursor: state.cursor\r\n  }\r\n}\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    onChange: (no,text) => {\r\n      dispatch(changeLine(no, text, Render(no, text)))\r\n    },\r\n    onUp: (upText) => (no, col, text) => {\r\n      if(no <= 0){\r\n        return;\r\n      }\r\n      let pos = getCursorPos(col,text);\r\n      if(isBlock(text) && pos[1] > 0){\r\n        return;\r\n      }\r\n      if(isBlock(upText.text)){\r\n        let lines = getLines(upText.text);\r\n        lines.pop()\r\n        let firstPart = lines.join(\"\\n\");\r\n        dispatch(setCursor(no - 1, firstPart.length + col, true))\r\n      }else{\r\n        dispatch(setCursor(no - 1, col, true))\r\n      }\r\n    },\r\n    onDown: (downText) => (no, col, text) => {\r\n      let num = numLines(text);\r\n      let pos = getCursorPos(col,text);\r\n      if(isBlock(text) && pos[1] < num - 1){\r\n        return;\r\n      }\r\n      if(isBlock(downText)){\r\n        let lines = getLines(downText);\r\n        let firstLine = lines[0];\r\n        dispatch(setCursor(no + 1, Math.min(col, firstLine.length), true))\r\n      }else{\r\n        dispatch(setCursor(no + 1, col, true))\r\n      }\r\n    },\r\n    onEnter: (no, text, pos, shift) => {\r\n      if(isBlock(text)){\r\n        if(shift){\r\n          dispatch(insertLine(no + 1, \"\", \"\"))\r\n          dispatch(setCursor(no + 1, 0, true))\r\n          return false;\r\n        }\r\n        return true;\r\n      }else{\r\n        dispatch(setCursor(no + 1, 0, true))\r\n        if(text === undefined)text = \"\"\r\n        let t1 = text.slice(0, pos)\r\n        dispatch(changeLine(no, t1, Render(no, t1)))\r\n        let t2 = text.slice(pos)\r\n        dispatch(insertLine(no + 1, t2, Render(no + 1, t2)))\r\n        return false; // prevent default\r\n      }\r\n    },\r\n    onTab: (no, text, shift) => {\r\n      if(shift){\r\n        if(text.search(/-+ /) === 0){ // already list\r\n          if(text.indexOf(\"- \") === 0){\r\n            text = text.slice(2);\r\n          }else{\r\n            text = text.slice(1);\r\n          }\r\n        }else{ // not list\r\n          // none\r\n        }\r\n      }else{\r\n        if(text.search(/-+/) === 0){ // already list\r\n          text = \"-\" + text\r\n        }else{ // first list\r\n          text = \"- \" + text\r\n        }\r\n      }\r\n      dispatch(changeLine(no, text, Render(no, text)))\r\n    },\r\n    onLeftUp: (pretext) => (no) =>{\r\n      if(no > 0){\r\n        dispatch(setCursor(no - 1, pretext.length, true))\r\n      }\r\n    },\r\n    onBSfunc: (pretext) => (no, text) =>{\r\n      dispatch(setCursor(no - 1, pretext.length, true))\r\n      let t = pretext + text;\r\n      dispatch(changeLine(no-1, t, Render(no - 1, t)))\r\n      dispatch(deleteLine(no))\r\n    },\r\n    onClick: (no) => {\r\n      dispatch(setCursor(no, 0, false))\r\n    },\r\n    onRefreshed: (no) => {\r\n      dispatch(setCursor(no, 0, false))\r\n    }\r\n  }\r\n}\r\n\r\nconst LinesContainer = connect(mapStateToProps, mapDispatchToProps)(Lines)\r\n\r\nexport default LinesContainer\r\n","import React from 'react'\r\nimport Lines from './Lines'\r\n\r\nconst App = () => (\r\n  <div>\r\n    <Lines />\r\n  </div>\r\n)\r\n\r\nexport default App\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createStore } from 'redux'\r\nimport { Provider } from 'react-redux'\r\nimport rootReducer from './reducers'\r\nimport App from './components/App'\r\nimport {insertLine} from './actions'\r\nimport './index.css';\r\nimport 'highlight.js/styles/github.css';  // choose your style!\r\nimport {Render} from './utils/render'\r\nimport {mermaidAPI} from 'mermaid'\r\n\r\nconst store = createStore(rootReducer)\r\n//const unsubscribe = store.subscribe(() => console.log(\"state\",store.getState()))\r\n\r\nmermaidAPI.initialize({startOnLoad: true, theme: 'forest'});\r\n\r\nfunction loadLine(no, text){\r\n  store.dispatch(insertLine(no, text, Render(no,text)))\r\n}\r\n\r\nloadLine(0, \"# React.jsで作ったインラインマークダウンエディタ\")\r\nloadLine(1, \"インラインで編集ができる書式付きエディタです。\")\r\nloadLine(2, \"ブロック記法に対応しました\")\r\nloadLine(3, \"## 整形済みテキスト\")\r\nloadLine(4, \">> pre\\n　 ∧,,∧\\n 　( `･ω･)\\n 　/　∽ |\")\r\nloadLine(5, \"## シンタックスハイライト\")\r\nloadLine(6, \">> code\\n//ソースコードみたいなの\\nfunction hoge(){\\n  alert('Hello World');\\n}\")\r\nloadLine(7, \"## mermaidによる作画\")\r\nloadLine(8, \">> mermaid\\ngraph LR\\n図も描けます\\nPlugin --> Pre\\n Plugin --> Mermaid\")\r\nloadLine(9, \"# 作った人\")\r\nloadLine(10, \"@ina_ani\")\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n)\r\n","var map = {\n\t\"./locale\": 29,\n\t\"./locale.js\": 29\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 60;"],"sourceRoot":""}