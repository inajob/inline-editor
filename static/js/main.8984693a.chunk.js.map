{"version":3,"sources":["reducers/lines.js","reducers/cursor.js","reducers/index.js","actions/index.js","components/Line.js","components/Lines.js","components/App.js","index.js"],"names":["lines","state","arguments","length","undefined","text","action","type","console","log","no","map","item","index","newState","slice","splice","cursor","col","row","combineReducers","insertLine","setCursor","Line","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","send","bind","assertThisInitialized","keyHandler","e","onChange","target","value","keyCode","onUp","onDown","onEnter","preventDefault","react_default","a","createElement","className","ref","onKeyDown","isFocus","refs","rawInput","focus","updateFocus","React","Component","Text","propTypes","PropTypes","func","isRequired","number","isRequires","string","Lines","line","components_Line","assign","key","addFocus","addClassName","indexOf","calcClassName","LinesContainer","connect","ownProps","dispatch","changeLine","App","components_Lines","store","createStore","rootReducer","subscribe","getState","ReactDOM","render","es","components_App","document","getElementById"],"mappings":"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","file":"static/js/main.8984693a.chunk.js","sourcesContent":["function lines(state = [{text:\"\"}], action){\r\n  switch(action.type){\r\n    case 'CHANGE_LINE':\r\n      console.log(\"CHANGE_LINE\", action.no, action.text)\r\n      return state.map((item, index) => {\r\n        if(index !== action.no){\r\n          return item\r\n        }\r\n        return {\r\n          text: action.text\r\n        }\r\n      })\r\n    case 'INSERT_LINE':\r\n      console.log(\"INSERT_LINE\", action.no, action.text)\r\n      let newState = state.slice()\r\n      newState.splice(action.no, 0, {text: action.text})\r\n      return newState\r\n  }\r\n  return state\r\n}\r\n\r\nexport default lines\r\n","function cursor(state = {col: 0, row: 0}, action){\r\n  switch(action.type){\r\n    case 'SET_CURSOR':\r\n    return {\r\n      row: action.row,\r\n      col: action.col,\r\n    }\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default cursor\r\n","import { combineReducers } from 'redux'\r\nimport lines from './lines'\r\nimport cursor from './cursor'\r\n\r\nexport default combineReducers({\r\n  lines,\r\n  cursor,\r\n})\r\n\r\n\r\n","\r\nexport const changeLine = (no, text) => ({\r\n  type: 'CHANGE_LINE',\r\n  text,\r\n  no,\r\n})\r\n\r\nexport const insertLine = (no, text) => ({\r\n  type: 'INSERT_LINE',\r\n  text,\r\n  no,\r\n})\r\n\r\nexport const setCursor = (row, col) => ({\r\n  type: 'SET_CURSOR',\r\n  row,\r\n  col,\r\n})\r\n\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types'\r\n\r\nclass Line extends React.Component{\r\n  constructor(props) {\r\n    super(props)\r\n    this.send = this.send.bind(this);\r\n    this.keyHandler = this.keyHandler.bind(this);\r\n  }\r\n  send(e){\r\n    this.props.onChange(this.props.no, e.target.value)\r\n    return;\r\n  }\r\n  keyHandler(e){\r\n    switch(e.keyCode){\r\n      case 38: //up\r\n      this.props.onUp(this.props.no)\r\n      break;\r\n      case 40: //down\r\n      this.props.onDown(this.props.no)\r\n      break;\r\n      case 13: //enter\r\n      this.props.onEnter(this.props.no)\r\n      e.preventDefault()\r\n      break;\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <div className={'line ' + this.props.className}>\r\n        <textarea ref=\"rawInput\" onChange={this.send} onKeyDown={this.keyHandler} value={this.props.text} />\r\n      </div>\r\n    )\r\n  }\r\n  updateFocus(){\r\n    if(this.props.isFocus){\r\n      this.refs.rawInput.focus();\r\n    }\r\n  }\r\n  componentDidUpdate(){\r\n    this.updateFocus()\r\n  }\r\n  componentDidMount(){\r\n    this.updateFocus()\r\n  }\r\n\r\n}\r\nText.propTypes = {\r\n  onChange: PropTypes.func.isRequired,\r\n  onUp: PropTypes.func.isRequired,\r\n  onDown: PropTypes.func.isRequired,\r\n  no: PropTypes.number.isRequires,\r\n  text: PropTypes.string.isRequired\r\n}\r\n\r\nexport default Line\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport PropTypes from 'prop-types'\r\nimport {changeLine, insertLine, setCursor} from '../actions'\r\nimport Line from './Line'\r\n\r\nclass Lines extends React.Component{\r\n  constructor(props) {\r\n    super(props)\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.props.lines.map((line, index) => (\r\n          <Line key={index} {...line} onChange={this.props.onChange} onUp={this.props.onUp} onDown={this.props.onDown} onEnter={this.props.onEnter} />\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n}\r\nLines.propTypes = {\r\n  onChange: PropTypes.func.isRequired,\r\n}\r\n\r\nconst addNumber = (lines => {\r\n  return lines.map((line, index) => {\r\n    line.no = index\r\n    return line;\r\n  })\r\n})\r\nconst addFocus = ((row, lines) => {\r\n  return lines.map((line, index) => {\r\n    if(index == row){\r\n      line.isFocus = true;\r\n    }else{\r\n      line.isFocus = false;\r\n    }\r\n    return line;\r\n  });\r\n})\r\nconst calcClassName = (text) => {\r\n  let className = \"normal\"\r\n  if(text.indexOf(\"###\") == 0){\r\n    className = \"h3\"\r\n  }else if(text.indexOf(\"##\") == 0){\r\n    className = \"h2\"\r\n  }else if(text.indexOf(\"#\") == 0){\r\n    className = \"h1\"\r\n  }\r\n  return className;\r\n}\r\nconst addClassName = (lines => {\r\n  return lines.map(line => {\r\n    line.className = calcClassName(line.text);\r\n    if(line.isFocus){\r\n      line.className += \" focus\"\r\n    }\r\n    return line;\r\n  })\r\n})\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  return {\r\n    lines: addClassName(addFocus(state.cursor.row, addNumber(state.lines))),\r\n    cursor: state.cursor\r\n  }\r\n}\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    onChange: (no,text) => {\r\n      dispatch(changeLine(no, text))\r\n    },\r\n    onUp: (no) => {\r\n      if(no > 0){\r\n        dispatch(setCursor(no - 1))\r\n      }\r\n    },\r\n    onDown: (no) => {\r\n      dispatch(setCursor(no + 1))\r\n    },\r\n    onEnter: (no) => {\r\n      dispatch(setCursor(no + 1))\r\n      dispatch(insertLine(no + 1, \"\"))\r\n    },\r\n  }\r\n}\r\n\r\nconst LinesContainer = connect(mapStateToProps, mapDispatchToProps)(Lines)\r\n\r\n\r\nexport default LinesContainer\r\n","import React from 'react'\r\nimport Lines from './Lines'\r\n\r\nconst App = () => (\r\n  <div>\r\n    <Lines />\r\n  </div>\r\n)\r\n\r\nexport default App\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createStore } from 'redux'\r\nimport { Provider } from 'react-redux'\r\nimport rootReducer from './reducers'\r\nimport App from './components/App'\r\nimport {insertLine, changeLine} from './actions'\r\nimport './index.css';\r\n\r\nconst store = createStore(rootReducer)\r\nconst unsubscribe = store.subscribe(() => console.log(\"state\",store.getState()))\r\n\r\nstore.dispatch(insertLine(0,\"# React.jsで作ったインラインマークダウンエディタ\"))\r\nstore.dispatch(insertLine(1,\"カーソル移動などまだおかしいです。\"))\r\nstore.dispatch(insertLine(2,\"## 作った人\"))\r\nstore.dispatch(insertLine(3,\"@ina_ani\"))\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}