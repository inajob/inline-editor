(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,n,t){e.exports=t(28)},27:function(e,n,t){},28:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),i=t(5),s=t.n(i),c=t(3),a=t(9);var p=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{text:""}],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PREVIEW_LINE":return console.log("PREVIEW_LINE",t.no,t.preview),n.map(function(e,n){return n!==t.no?e:{text:e.text,preview:t.preview}});case"CHANGE_LINE":return console.log("CHANGE_LINE",t.no,t.text),n.map(function(e,n){return n!==t.no?e:{text:t.text,preview:t.preview}});case"INSERT_LINE":return console.log("INSERT_LINE",t.no,t.text),(e=n.slice()).splice(t.no,0,{text:t.text,preview:t.preview}),e;case"DELETE_LINE":return console.log("DELETE_LINE",t.no),(e=n.slice()).splice(t.no,1),e}return n};var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{col:0,row:0,dirty:!1},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_CURSOR":return{row:n.row,col:n.col,dirty:n.dirty}}return e},l=Object(c.b)({lines:p,cursor:u}),f=t(6),d=t(7),h=t(11),v=t(8),E=t(10),g=function(e,n,t){return{type:"CHANGE_LINE",text:n,preview:t,no:e}},x=function(e,n,t){return{type:"INSERT_LINE",text:n,preview:t,no:e}},m=function(e,n,t){return{type:"SET_CURSOR",row:e,col:n,dirty:t}},y=t(2),k=t(1),w=t.n(k),b=function(e){function n(e){var t;return Object(f.a)(this,n),(t=Object(h.a)(this,Object(v.a)(n).call(this,e))).send=t.send.bind(Object(y.a)(t)),t.keyHandler=t.keyHandler.bind(Object(y.a)(t)),t.clickHandler=t.clickHandler.bind(Object(y.a)(t)),t}return Object(E.a)(n,e),Object(d.a)(n,[{key:"send",value:function(e){this.props.onChange(this.props.no,e.target.value)}},{key:"keyHandler",value:function(e){switch(e.keyCode){case 38:this.props.onUp(this.props.no,e.target.selectionStart,this.props.text);break;case 40:this.props.onDown(this.props.no,e.target.selectionStart,this.props.text);break;case 37:0===e.target.selectionStart&&0===e.target.selectionEnd&&this.props.onLeftUp(this.props.no);break;case 39:e.target.selectionStart===this.props.text.length&&this.props.onDown(this.props.no,0);break;case 13:this.props.onEnter(this.props.no,this.props.text,e.target.selectionStart)||e.preventDefault();break;case 8:0===e.target.selectionStart&&0===e.target.selectionEnd&&(this.props.onBS(this.props.no,this.props.text),e.preventDefault())}}},{key:"clickHandler",value:function(e){this.props.onClick(this.props.no)}},{key:"render",value:function(){return o.a.createElement("div",{className:"line "+this.props.className,onClick:this.clickHandler},o.a.createElement("div",{style:{display:this.props.isFocus?"block":"none"}},o.a.createElement("textarea",{ref:"rawInput",style:{height:this.props.height},onChange:this.send,onKeyDown:this.keyHandler,value:this.props.text})),o.a.createElement("div",{style:{display:this.props.isFocus?"none":"block"}},o.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.preview}})))}},{key:"updateFocus",value:function(){if(this.props.isFocus&&(this.refs.rawInput.focus(),this.props.dirty)){var e=this;setTimeout(function(){console.log("update cursor"),e.refs.rawInput.setSelectionRange(e.props.column,e.props.column),e.props.onRefreshed(e.props.no)},10)}}},{key:"componentDidUpdate",value:function(){this.updateFocus()}},{key:"componentDidMount",value:function(){this.updateFocus()}}]),n}(o.a.Component);Text.propTypes={onChange:w.a.func.isRequired,onUp:w.a.func.isRequired,onDown:w.a.func.isRequired,onClick:w.a.func.isRequired,onLeftUp:w.a.func.isRequired,onBS:w.a.func.isRequired,onRefreshed:w.a.func.isRequired,no:w.a.number.isRequires,text:w.a.string.isRequired};var R=b,O=function(e){if(console.log("Render",e),j(e)){var n=N(e),t=n[0],r=n.slice(1),o=t.split(/\s+/),i="";if(console.log("PARTS:",o),">>"===o[0])switch(o[1]){case"pre":i+="<span class='mode'>&gt;&gt; pre</span>",i+="<pre>"+r.join("\n")+"</pre>";break;default:i+="<pre>"+e+"</pre>"}else i+="<pre>"+e+"</pre>";return i}return 0===e.indexOf("###")?"<div>"+e+"<div>":0===e.indexOf("##")?"<div>"+e+"<div>":0===e.indexOf("#")?"<div>"+e+"<div>":"<div>"+e+"</div>"},j=function(e){return 0===e.indexOf(">>")},I=function(e,n){var t,r=n.split(/[\r\n]/),o=0;for(t=0;t<r.length;t++)if((o+=r[t].length+1)>e)return[e-(o-r[t].length-1),t];console.log("error getPos")},N=function(e){return e.split(/[\r\n]/)},S=function(e){return e.split(/[\r\n]/).length},C=function(e){function n(){return Object(f.a)(this,n),Object(h.a)(this,Object(v.a)(n).apply(this,arguments))}return Object(E.a)(n,e),Object(d.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,this.props.lines.map(function(n,t){return o.a.createElement(R,Object.assign({key:t},n,{onChange:e.props.onChange,onUp:e.props.onUp(0===t?"":e.props.lines[t-1]),onDown:e.props.onDown(t>=e.props.lines.length-1?"":e.props.lines[t+1]),onEnter:e.props.onEnter,onClick:e.props.onClick,onLeftUp:e.props.onLeftUp(0===t?"":e.props.lines[t-1]),onBS:e.props.onBSfunc(0===t?"":e.props.lines[t-1]),onRefreshed:e.props.onRefreshed}))}))}}]),n}(o.a.Component),L=function(e,n,t,r){return r.map(function(r,o){return o===n?(r.isFocus=!0,r.column=e,r.dirty=t):r.isFocus=!1,r})},_=function(e){return e.map(function(e){return e.className=function(e){var n="normal";return j(e)?n="block":0===e.indexOf("###")?n="h3":0===e.indexOf("##")?n="h2":0===e.indexOf("#")&&(n="h1"),n}(e.text),e.isFocus&&(e.className+=" focus"),e})},D=function(e){return e.map(function(e){return e.height=16*S(e.text)+"px",e})},H=Object(a.b)(function(e,n){return{lines:_(D(L(e.cursor.col,e.cursor.row,e.cursor.dirty,(t=e.lines,t.map(function(e,n){return e.no=n,e}))))),cursor:e.cursor};var t},function(e){return{onChange:function(n,t){e(g(n,t,O(t)))},onUp:function(n){return function(t,r,o){if(!(t<=0)){var i=I(r,o);if(!(j(o)&&i[1]>0))if(j(n.text)){var s=N(n.text);s.pop();var c=s.join("\n");e(m(t-1,c.length+r,!0))}else e(m(t-1,r,!0))}}},onDown:function(n){return function(t,r,o){var i=S(o),s=I(r,o);if(!(j(o)&&s[1]<i-1))if(j(n.text)){var c=N(n.text)[0];e(m(t+1,Math.min(r,c.length),!0))}else e(m(t+1,r,!0))}},onEnter:function(n,t,r){if(j(t))return!0;e(m(n+1,0,!0)),void 0===t&&(t="");var o=t.slice(0,r);e(g(n,o,O(o)));var i=t.slice(r);return e(x(n+1,i,O(i))),!1},onLeftUp:function(n){return function(t){t>0&&e(m(t-1,n.text.length,!0))}},onBSfunc:function(n){return function(t,r){e(m(t-1,n.text.length,!0));var o=n.text+r;e(g(t-1,o,O(o))),e(function(e,n){return{type:"DELETE_LINE",text:n,no:e}}(t))}},onClick:function(n){e(m(n,0,!1))},onRefreshed:function(n){e(m(n,0,!1))}}})(C),T=function(){return o.a.createElement("div",null,o.a.createElement(H,null))},U=(t(27),Object(c.c)(l));U.dispatch(x(0,"# React.js\u3067\u4f5c\u3063\u305f\u30a4\u30f3\u30e9\u30a4\u30f3\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u30a8\u30c7\u30a3\u30bf",O("# React.js\u3067\u4f5c\u3063\u305f\u30a4\u30f3\u30e9\u30a4\u30f3\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u30a8\u30c7\u30a3\u30bf")));var q="\u30d6\u30ed\u30c3\u30af\u8a18\u6cd5\u306b\u5bfe\u5fdc\u3057\u307e\u3057\u305f";U.dispatch(x(1,q,O(q))),q=">> pre\n//\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u307f\u305f\u3044\u306a\u306e\n alert('Hello World');",U.dispatch(x(2,q,O(q))),U.dispatch(x(3,"## \u4f5c\u3063\u305f\u4eba",O("## \u4f5c\u3063\u305f\u4eba"))),U.dispatch(x(4,"@ina_ani",O("@ina_ani"))),s.a.render(o.a.createElement(a.a,{store:U},o.a.createElement(T,null)),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.ce226b74.chunk.js.map